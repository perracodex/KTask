# Copyright (c) 2024-Present Perracodex. Use of this source code is governed by an MIT license.

security {
	# When true, it enables the 'HttpsRedirect' to redirect all HTTP requests to the HTTPS counterpart
	# before processing any call, and the 'HSTS' plugin to add the required HTTP Strict Transport Security
	# headers to all the requests.
	useSecureConnection: false
	useSecureConnection: ${?KTASK_SECURITY_SECURE_CONNECTIONS}

	# Constraints to be use for endpoints rate limiting.
	constraints {
		publicApi {
			# Maximum number of requests allowed for the Public API.
			# Default is 10_000 requests per second.
			limit: 10000
			limit: ${?KTASK_SECURITY_CONSTRAINTS_PUBLIC_API_LIMIT}
			refillMs: 1000 # 1 second.
			refillMs: ${?KTASK_SECURITY_CONSTRAINTS_PUBLIC_API_REFILL_MS}
		}

		privateApi {
			# Maximum number of requests allowed for the Private API.
			# Default is 10_000 requests per second.
			limit: 10000
			limit: ${?KTASK_SECURITY_CONSTRAINTS_PRIVATE_API_LIMIT}
			refillMs: 1000 # 1 second.
			refillMs: ${?KTASK_SECURITY_CONSTRAINTS_PRIVATE_API_REFILL_MS}
		}

		newToken {
			# Maximum number of requests allowed for a New Authentication Token generation.
			# Default is 1000 requests every 10 seconds.
			limit: 1000
			limit: ${?KTASK_SECURITY_CONSTRAINTS_NEW_TOKEN_LIMIT}
			refillMs: 10000 # 10 seconds.
			refillMs: ${?KTASK_SECURITY_CONSTRAINTS_NEW_TOKEN_REFILL_MS}
		}
	}
}
